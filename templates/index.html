<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Notification App</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
<div class="flex items-center justify-center min-h-screen">
    <div class="container mx-auto p-4 flex flex-col items-center justify-center max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
        <h1 class="text-3xl font-bold mb-4">Elderly Companion App</h1>

        <!-- Purpose Selection Buttons -->
        <div class="mb-8 flex">
            <button id="notificationBtn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105" onclick="toggleForms('notification')">Schedule a Notification</button>
            <button id="appointmentBtn" class="ml-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105" onclick="toggleForms('appointment')">Book an Appointment</button>
        </div>

        <!-- Notification Form -->
        <div id="notificationFormDiv" class="bg-white p-6 rounded-lg shadow-md mb-8 hidden w-full md:w-3/2 transition duration-500 ease-in-out transform">
            <h2 class="text-2xl font-semibold mb-4">Schedule a Notification</h2>
            <form id="notificationForm" class="space-y-4">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
                    <input type="text" id="name" name="name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                    <input type="email" id="email" name="email" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="condition" class="block text-sm font-medium text-gray-700">Condition</label>
                    <input type="text" id="condition" name="condition" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="age" class="block text-sm font-medium text-gray-700">Age</label>
                    <input type="number" id="age" name="age" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="notificationType" class="block text-sm font-medium text-gray-700">Notification Type</label>
                    <select id="notificationType" name="notificationType" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <option value="motivational">Motivational</option>
                        <option value="medicational">Medicational</option>
                        <option value="advice">Advice</option>
                    </select>
                </div>
                <div>
                    <label for="time" class="block text-sm font-medium text-gray-700">Time (optional)</label>
                    <input type="time" id="time" name="time" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105">Schedule Notification</button>
            </form>
        </div>

        <!-- Appointment Booking Form -->
        <div id="appointmentFormDiv" class="bg-white p-6 rounded-lg shadow-md hidden w-full md:w-3/2 transition duration-500 ease-in-out transform">
            <h2 class="text-2xl font-semibold mb-4">Book an Appointment</h2>
            <form id="appointmentForm" class="space-y-4">
                <div>
                    <label for="appointmentName" class="block text-sm font-medium text-gray-700">Name</label>
                    <input type="text" id="appointmentName" name="appointmentName" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="appointmentEmail" class="block text-sm font-medium text-gray-700">Email</label>
                    <input type="email" id="appointmentEmail" name="appointmentEmail" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="doctor" class="block text-sm font-medium text-gray-700">Select Doctor</label>
                    <select id="doctor" name="doctor" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <option value="" disabled selected>Select a Doctor</option>
                    </select>
                </div>
                <div>
                    <label for="appointmentDate" class="block text-sm font-medium text-gray-700">Date</label>
                    <input type="date" id="appointmentDate" name="appointmentDate" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div>
                    <label for="appointmentTime" class="block text-sm font-medium text-gray-700">Time</label>
                    <input type="time" id="appointmentTime" name="appointmentTime" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <button type="submit" class="w-full bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105">Book Appointment</button>
            </form>
        </div>
    </div>
</div>

<script>
    const socket = io();

    function toggleForms(formType) {
        if (formType === 'notification') {
            document.getElementById('notificationFormDiv').classList.remove('hidden');
            document.getElementById('appointmentFormDiv').classList.add('hidden');
        } else if (formType === 'appointment') {
            document.getElementById('notificationFormDiv').classList.add('hidden');
            document.getElementById('appointmentFormDiv').classList.remove('hidden');
            // Fetch doctors list dynamically
            fetchDoctors();
        }
    }

    function fetchDoctors() {
        const doctors = [
            { id: 1, name: 'Dr. John Doe', specialty: 'Cardiology' },
            { id: 2, name: 'Dr. Jane Smith', specialty: 'Neurology' },
            { id: 3, name: 'Dr. Michael Brown', specialty: 'Pediatrics' },
            { id: 4, name: 'Dr. Sarah Lee', specialty: 'Dermatology' },
            { id: 5, name: 'Dr. Robert Clark', specialty: 'Ophthalmology' },
            { id: 6, name: 'Dr. Emily Davis', specialty: 'Orthopedics' },
            { id: 7, name: 'Dr. Andrew Wilson', specialty: 'ENT' },
            { id: 8, name: 'Dr. Laura Johnson', specialty: 'Psychiatry' },
            { id: 9, name: 'Dr. William Martinez', specialty: 'Urology' },
            { id: 10, name: 'Dr. Elizabeth Thomas', specialty: 'Gynecology' }
        ];

        const doctorSelect = document.getElementById('doctor');
        doctorSelect.innerHTML = ''; // Clear existing options
        doctors.forEach(doctor => {
            const option = document.createElement('option');
            option.value = doctor.id;
            option.textContent = `${doctor.name} (${doctor.specialty})`;
            doctorSelect.appendChild(option);
        });
    }

    document.getElementById('notificationForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        fetch('/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            e.target.reset(); // Clear form fields
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
        });
    });

    document.getElementById('appointmentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        fetch('/bookAppointment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            e.target.reset(); // Clear form fields
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
        });
    });

    socket.on('connect', function() {
        console.log('Connected to server');
    });

    socket.on('disconnect', function() {
        console.log('Disconnected from server');
    });
</script>

</body>
</html>
